<!doctype html>
<html lang="en">

	<head>
		<meta charset="utf-8">

		<title>The CLI and You: A Love Story</title>

		<meta name="description" content="A presentation about the CLI">
		<meta name="author" content="Kandasamy Kandasamy Chokkalingam">

		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

		<script src="https://livejs.com/live.js"></script>



		<meta name="viewport" content="width=device-width, initial-scale=1.0">

		<link rel="stylesheet" href="https://rsms.me/inter/inter.css">
		<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/aymanbagabas/iosevka-fonts/dist/iosevka/iosevka.min.css">
		<link rel="stylesheet" href="/css/pres/cliandyou/reset.css">
		<link rel="stylesheet" href="/css/pres/cliandyou/reveal.css">
		<link rel="stylesheet" href="/css/pres/cliandyou/ksam.css" id="theme">

		<!-- Theme used for syntax highlighting of code -->
		<link rel="stylesheet" href="/js/pres/cliandyou/plugin/highlight/atom-one-dark.css">
	</head>

	<body>

		<div class="reveal">

			<!-- Any section element inside of this container is displayed as a slide -->
			<div class="slides">
				<section>
					<h1>The CLI and you</h1>
					<h3><strike>A Love Story</strike></h3>
					<h3>An Educational Story</h3>
				</section>
				<section>
					<h2>Overview</h2>
					<p>We'll be making a simple TODO app (very unique)</p>

					<p>We'll introduce new features/commands as we go on</p>

					<p>I've included the scripts in the github repo, but I recommend you try and type it out too</p>
				</section>

				<section>
					<h2>Why should you love the CLI?</h2>

						<p class="fragment">It's everywhere</p>
						<p class="fragment">It's powerful</p>
						<p class="fragment">It will never leave you</p>
				</section>

				<section>
					<h1>Who is using the CLI?</h2>
					<h1 class="r-fit-text fragment" data-fragment-index="1">everyone<span class="fragment" data-fragment-index="2">*</span></h1>

					<p class="fragment" data-fragment-index="2">*I Think</p>
				</section>

				<section>
					<h2>Terminology</h2>
					<p><b>Kernel</b>: Operating System Core</p>
					<p><b>Shell</b>: OS's outermost user interface</p>
					<p><b>Console</b>: Physical Terminal</p>
					<p><b>Terminal</b>: Text Input/Output Environment</p>
					<p><b>Terminal Emulator</b>: Text Input/Output Environment provided by some software program</p>
					<p><b>Command Line Interface</b>: Some sort of text interface where commands are input and executed using <code>Return</code></p>
				</section>

				<section>
					<h2>CLI Basics</h2>
					<p><b>ls</b> lists files in directory</p>
					<p><b>cd</b> changes directories (.. is the parent directory)</p>
					<p><b>pwd</b> prints the name of the current directory</p>
					<p><b><code>CTRL+C</code></b> kills the running command</p>
					<p><b><code>â†‘</code></b> Gets the previous command</p>
					<p><b><code>TAB</code></b> Autocompletes</p>
				</section>

				<section>
					<h2>Running Bash Programs</h2>
					<p>We can run commands one at a time in the CLI</p>
					<p>We can also put them into executable files to run many</p>
				</section>

				<section>
					<h2>Setup</h2>
					<p>If you haven't already, fork and clone the <a href="https://github.com/kandasamyc/cliandyou">workshop repo</a></p>
					<p>Change directories into there</p>
					<p>Each piece of this workshop has a specific folder</p>
					<p>You should create your own file to work in</p>
					<p>Each folder will have an answer file too</p>
				</section>

				<section>
					<h1>Part 1: Hello, World!</h1>
				</section>

				<section>
					<h2><code>echo</code></h2>
					<p><code>echo</code> prints a given string to standard output</p>
					<pre><code class="language-bash"> &gt;&gt;&gt; echo "Hello, World!"</code></pre>
				</section>

				<section>
					<h2>Out of the CLI, into the file</h2>
					<p>Let's make a file called <code>part1</code></p>
					<p>Bash files commonly have no extension but .sh is used sometimes</p>
					<p>Run this command in the part1 directory</p>
					<pre><code class="language-bash"> ksam@laptop:~/cliandyou/part1$ touch part1</code></pre>
					<p><code>touch</code> creates an empty file with the given name in the current directory</p>
				</section>

				<section>
					<h2>Out of the CLI, into the file</h2>
					<p>Open <code>part1</code> in an editor</p>

					<pre><code class="language-bash" data-trim data-line-numbers="1|3">
							#!/bin/bash

							echo "Hello, World!"
					</code></pre>

					<p>Line 1 is a <b>shebang</b> that tells the OS what interpreter to use</p>
					<p><code class="language-bash">#!/usr/bin/env bash</code> is another common one for bash</p>
				</section>

				<section>
					<h2>Running bash scripts</h2>
					<p>There are two ways to run scripts, with just the path or with another command</p>
					<p>We can type the file's name with a relative or absolute path</p>
					<pre><code class="language-bash" data-trim data-line-numbers="">
							ksam@laptop:~/cliandyou/part1$ ./part1
							ksam@laptop:~/cliandyou/part1$ /path/to/cliandyou/folder/part1/part1
					</code></pre>
					<p>Or we can use a shell command like <code>bash</code> or <code>sh</code></p>
					<pre><code class="language-bash" data-trim data-line-numbers="">
							ksam@laptop:~/cliandyou/part1$ bash part1
							ksam@laptop:~/cliandyou/part1$ sh part1
							ksam@laptop:~/cliandyou/part1$ bash /path/to/cliandyou/folder/part1/part1
					</code></pre>
				</section>

				<section>
					<h2>A Small Issue</h2>
					<p>If you tried the path method above, it doesn't work (yet)</p>
					<pre><code>bash: ./part1: Permission denied</code></pre>
					<p>All files have permissions that dicatate if they can be read, written, or executed by the owner, group, or everyone</p>
					<pre><code class="language-bash" data-trim>
							ksam@laptop:~/cliandyou/part1$ ls -l
							total 1
							-rw-rw-r-- 1 ksam ksam  35 Nov 25 18:14 part1
					</code></pre>
					<p><code>ls -l</code> lists all the files (non-hidden) with more info</p>
					<p>We can solve this by adding execution permissions</p>
					<pre><code class="language-bash" data-trim>ksam@laptop:~/cliandyou/part1$ chmod +x</code></pre>
				</section>

				<section>
					<h1>Part 2: Conditionals, Functions, and IO</h1>
				</section>

				<section>
					<h2>Details, Details</h2>
					<p>We'll have 4 actions</p>
					<p>add: Adds a task with a name, due date and category</p>
					<p>info: lists all tasks that are done, pending or all</p>
					<p>delete: Removes a task with a given name</p>
					<p>progress: Moves a task from todo -> pending -> done</p>
				</section>

				<section>
					<h2>Positional Parameters</h2>
					<pre><code class="language-bash">ksam@laptop:~/cliandyou/part2$ part2 add "Get Eggs" "2021-12-02" "shopping"</code></pre>
					<p>We can get each of these with a <b>Positional Parameter</b> in the form of <code>$number</code></p>
					<p>Each thing separated by a space counts as its own argument</p>
					<p>Counting starts from 1, 0 is the command run</p>
					<pre>
						<code class="language-bash" data-line-numbers="" data-trim>
							echo $1 # prints add
							echo $2 # prints Get Eggs
							echo $3 # prints 2021-12-02
							echo $4 # prints shopping
						</code>
					</pre>
				</section>

				<section>
					<h2>If,</h2>
					<p>If the command is add, print a</p>
					<pre>
						<code class="language=bash" data-line-numbers="" data-trim>
							if [ $1 == "add" ]
							then
							    echo "a"
							fi
						</code>
					</pre>
				</section>

				<section>
					<h2>Else if,</h2>
					<p>Otherwise, check if its any of the other commands and print their first letter</p>
					<pre>
						<code class="language-bash" data-line-numbers="" data-trim>
							if [ $1 == "add" ]; then
							    echo "a"
							elif [ $1 == "info" ]; then
							    echo "i"
							elif [ $1 == "delete" ]; then
							    echo "d"
							elif [ $1 == "progress" ]; then
							    echo "p"
							fi
						</code>
					</pre>
				</section>

				<section>
					<h2>else.</h2>
					<p>Else, print a warning</p>
					<pre>
						<code class="language-bash" data-line-numbers="" data-trim>
							if [ $1 == "add" ]; then
							    echo "a"
							elif [ $1 == "info" ]; then
							    echo "i"
							elif [ $1 == "delete" ]; then
							    echo "d"
							elif [ $1 == "progress" ]; then
							    echo "p"
							else
							    echo "$1 is not a valid command"
							fi
						</code>
					</pre>
				</section>

				<section>
					<h2>Inception</h2>
					<p>Try not giving a command. What happens?</p>
					<pre>
						<code class="language-plaintext" data-trim>
							./part2test: line 3: [: ==: unary operator expected
							./part2test: line 5: [: ==: unary operator expected
							./part2test: line 7: [: ==: unary operator expected
							./part2test: line 9: [: ==: unary operator expected
							is not a valid command
						</code>
					</pre>
					<p>There is no such parameter, so bash gets confused</p>
					<pre class="fragment">
						<code class="language-bash" data-line-numbers="" data-trim>
							if [ -n $1 ]; then
							    if [ $1 == "add" ]; then
							        echo "a"
							    elif [ $1 == "info" ]; then
							        echo "i"
							    elif [ $1 == "delete" ]; then
							        echo "d"
							    elif [ $1 == "progress" ]; then
							        echo "p"
							    else
							        echo "$1 is not a valid command"
							    fi
							else
							    echo "No command given"
							fi
						</code>
					</pre>
				</section>

				<section>
					<h2>Switching It Up</h2>
					<p>If statements are nice, but a bit messy</p>
					<p>Switch cases fit our use a bit better</p>
					<pre class="fragment">
						<code class="language-bash" data-line-numbers="" data-trim>
							if [ -n $1 ]; then
							    case $1 in
							        "add")
							             echo "a";;
							         "info")
							             echo "i";;
							          "delete")
							             echo "d";;
							          "progress")
							             echo "p";;
							          "*")
							             echo "$1 is not a valid command";;
							    esac
							else
							    echo "No command given"
							fi
						</code>
					</pre>
				</section>

				<section>
					<h2>Everybody loves bash functions</h2>
					<p>We can write in the if statement, but that's messy</p>
					<pre class="fragment">
						<code class="language-bash" data-trim data-line-numbers="1-15|16-32">
							add () {
							    echo "a";
							}

							info () {
							    echo "i";
							}

							delete () {
							    echo "d";
							}

							progress () {
							    echo "p";
							}

							if [ -n $1 ]; then
							    case $1 in
							        "add")
							             add ;;
							         "info")
							             info ;;
							          "delete")
							             delete ;;
							          "progress")
							             progress ;;
							          "*")
							             echo "$1 is not a valid command";;
							    esac
							else
							    echo "No command given"
							fi
						</code>
					</pre>
				</section>

				<section>
					<h2>and their parameters</h2>
					<p>Let's pass parameters</p>
					<pre class="fragment">
						<code class="language-bash" data-trim data-line-numbers="1-15|16-32">
							add () {
							    echo $1 $2 $3;
							}

							info () {
							}

							delete () {
							    echo $1;
							}

							progress () {
							    echo $1;
							}

							if [ -n $1 ]; then
							    case $1 in
							        "add")
							             add $2 $3 $4;;
							         "info")
							             info;;
							          "delete")
							             delete $2;;
							          "progress")
							             progress $2;;
							          "*")
							             echo "$1 is not a valid command";;
							    esac
							else
							    echo "No command given"
							fi
						</code>
					</pre>
				</section>

				<section>
					<h1>Part 3: awk for fun and profit</h1>
				</section>

				<section>
					<h2>Details 2: Electric Boogaloo</h2>
					<p>How should we store data?</p>
					<p class="fragment" data-fragment-index="1">CSV format</p>
					<p class="fragment" data-fragment-index="1">We need to store an id, a name, a due date, a category, and a state</p>
					<pre class="fragment" data-fragment-index="1">
						<code class="language-plaintext" data-trim data-line-numbers="">
							1,Get Eggs,2021-12-02,shopping,todo
							2,Get Milk,2021-12-02,shopping,pending
						</code>
					</pre>
					<p class="fragment" data-fragment-index="1">It'll be in a file in the current directory called todos.txt</p>
				</section>

				<section>
					<h2>Redirects</h2>
					<p>When adding a task, we need to output to the file</p>
					<p><code>&gt;</code> overwrites, <code>&gt;&gt;</code> appends</p>
					<p><code>let</code> allows us to do math</p>
					<pre>
						<code class="language-bash" data-trim data-line-numbers="">
							add () {
							    let taskid+=1
								echo "$taskid,$1,$2,$3,todo" >> ./todos.txt
							}
						</code>
					</pre>
					<p>taskid is the current highest taskid</p>
				</section>

				<section>
					<h2>Intro to awk</h2>
					<p>awk is a row and column processor</p>
					<p>We can define actions to be taken on every row and column to filter, modify, and process them</p>
					<p>The basic format of an awk command is</p>
					<pre>
						<code class="language-plaintext" data-trim>
							awk -F "separator" ' {action to perform on every row} file-to-act-on.extension'
						</code>
					</pre>
				</section>

				<section>
					<h2>More awk</h2>
					<p>In awk, the action defined in the main braces is run on every row</p>
					<p>You can access each column with $1, $2, $3...</p>
					<p><code>print</code> will print to console</p>
				</section>

				<section>
					<h2>A little more awk</h2>
					<p>You can pass variables with the <code>-v</code> argument</p>
					<pre>
						<code class="language-plaintext" data-trim>
							awk -v myvar=$1 '{ print myvar }'
						</code>
					</pre>
					<p>This prints the value of <code>$1</code>, whatever it may be</p>
					<p>We can also write to a file by echoing awk's output and redirecting to a file</p>
					<pre>
						<code class="language-plaintext" data-trim>
							echo "$(awk command)" > file
						</code>
					</pre>
					<p><code>$(command)</code> gets the output of executing said command</p>
				</section>

				<section>
					<h2>info</h2>
					<p>How? <span class="fragment" data-fragment-index="1">printf/formatted printing</code></p>
					<p class="fragment" data-fragment-index="1">printf allows us to format input (%{space}{type})</p>
					<p class="fragment" data-fragment-index="1">It auto pads input</p>
					<pre class="fragment" data-fragment-index="2">
						<code class="language-bash" data-line-numbers="" data-trim>
							info () {
							    echo "All tasks"
							    echo "$(awk -F "," '{printf("|%1s|%+15s|%12s|%11s|%10s|\n", $1, $2, $3, $4, $5)}' todos.txt)"
							}
						</code>
					</pre>
				</section>

				<section>
					<h2>delete</h2>
					<p>How? <span class="fragment" data-fragment-index="1">Filter its id out</span></p>
					<p class="fragment" data-fragment-index="1"><code>'{ if (condition) { action } }'</code></p>
					<pre class="fragment" data-fragment-index="2">
						<code class="language-bash" data-line-numbers="" data-trim>
							delete () {
							    echo "$(awk -F "," -v taskid=$1 '{ if ($1 != taskid ) { print }}' todos.txt)" > ./todos.txt
							}
						</code>
					</pre>
				</section>

				<section>
					<h2>progress</h2>
					<p>How? <span class="fragment" data-fragment-index="1">Filter by id, and change state based on current one</span></p>
					<p class="fragment" data-fragment-index="1"><code>'{ if ($1 == taskid) { if (state) {new state} }'</code></p>
					<pre class="fragment" data-fragment-index="2">
						<code class="language-bash" data-line-numbers="" data-trim>
							progress () {
							    echo "$(awk -F "," -v taskid=$1 '{ {OFS = FS} if ( $1 == taskid ) { \
							    if ($5 == "todo" ) {\
							    $5="pending" \
							    } else if ( $5 == "pending" ) {\
							    $5="done" }\
							    };\
							    print $0}' todos.txt)" > ./todos.txt
							}
						</code>
					</pre>
					<p class="fragment" data-fragment-index="2"><code>print $0</code> prints the whole line</p>
					<p class="fragment" data-fragment-index="2"><code>{OFS = FS}</code> prints our separators</p>
				</section>

				<section>
					<h2>Detective Work</h2>
					<p>Say we want to use another, older file</p>
					<pre><code class="language-bash">ksam@laptop:~/cliandyou/part3$ mv lotsoftodos.txt todos.txt</code></pre>
					<p>If we run info, and scroll down, we see something strange</p>
					<pre><code class="language-plaintext">|nice|    well|     this is|  weird.|2021-12-02|</code></pre>
					<p>How can we easily inspect the file?</p>
				</section>

				<section>
					<h2>Elementary, my dear Watson!</h2>
					<p>grep helps us search through a file to find occurrences of characters</p>
					<pre><code>ksam@laptop:~/cliandyou/part3$ grep -i nice lotsoftodos.txt</code></pre>
				</section>

				<section>
					<h1>Part 4: We're almost done I swear</h1>
				</section>

				<section>
					<h2>Review</h2>
					<p>We've learned about bash scripting</p>
					<p>We've made a super simple todo app</p>
					<p>The CLI loves you</p>
				</section>

				<section>
					<h2>Some practical snippets</h2>
					<pre>
						<code class="language-bash" data-trim data-line-numbers-"">
							export HOST_IP="$(ip route |awk '/^default/{print $3}')"
						</code>
					</pre>
					<p class="fragment">Get the ip of the current system with awk</p>
					<pre>
						<code class="language-bash" data-trim data-line-numbers-"">
							alias sd="sudo docker"
							sd exec -it $(sd ps | awk 'NR == 2 { print $1 }') /bin/bash
						</code>
					</pre>
					<p class="fragment">Launch the nth running docker container</p>
				</section>

				<section>
					<h2>Where do we go from here?</h2>
					<p>Look through more bash syntax</p>
					<p>Add other features</p>
					<p>Mess around on your own with the CLI</p>
				</section>

				<section>
					<h1>Fin.</h1>
	 			</section>

				<section data-visibility="uncounted">
					<p>Made with <3 and Reveal.js</p>
					<p>By Kandasamy Chokkalingam</p>
				</section>
			</div>

		</div>

		<script src="/js/pres/cliandyou/reveal.js"></script>
		<script src="/js/pres/cliandyou/plugin/notes/notes.js"></script>
		<script src="/js/pres/cliandyou/plugin/search/search.js"></script>
		<script src="/js/pres/cliandyou/plugin/highlight/highlight.js"></script>

		<script>

			// Also available as an ES module, see:
			// https://revealjs.com/initialization/
			Reveal.initialize({
				controls: false,
				progress: true,
				center: true,
				hash: true,

				// Learn about plugins: https://revealjs.com/plugins/
				plugins: [ RevealNotes, RevealSearch, RevealHighlight ]
			});

		</script>
<style>
  .reveal > .slides > section > section {
    transform-style: flat;
  }
</style>
	</body>
</html>
